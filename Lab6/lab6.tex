\input template.tex
\begin{document}
\selectlanguage{russian}
\maketitle 6 {МОДУЛИ И ДИНАМИЧЕСКИ ПОДКЛЮЧАЕМЫЕ БИБЛИОТЕКИ}
\setcounter{page}{2}
\normalfont
\ssec{Цель работы}

\vskip -1cm
Цель работы заключается в том, чтобы научиться создавать и использовать модули и библиотеки статической и динамической компоновки. Также требуется написать программу с их использованием.

\ 
\ssec{Задание на работу}
Cоставить программу вычисления для заданных значений x, y, z
арифметического выражения:
\input{formulae}
С помощью инспектора объектов изменить цвет формы, шрифт выводимых символов.
\vfill
\clearpage
\ssec{Теоретическая справка}
\loop{}\ifnum\thepage<5{\hrule\hfill\\}\repeat
\newcounter{lc}\setcounter{lc}{29}
\loop{}\ifnum\value{lc}>0{\addtocounter{lc}{-1}\hrule\hfill\\}\repeat
\ssec{Схема алгоритма}
\suppressfloats[p]
Ниже на рисунке \ref{gen} представлена схема алгоритма вычисления значения функции.
\pic{LAB1.png}{Схема алгоритма вычисления значения функции}{gen}{H}{1.0}
На рисунке \ref{inp} представлена схема алгоритма ввода параметров расчета значения функции.
\pic{LAB2.png}{Схема алгоритма ввода параметров функции}{inp}{H}{1.0}
На рисунке \ref{calc} представлена схема алгоритма ввода расчета значения функции от заданных параметров.
\pic{LAB3.png}{Схема алгоритма расчета значения функции}{calc}{H}{1.0}
На рисунке \ref{out} представлена схема алгоритма вывода расчитанного значения функции.
\pic{LAB4.png}{Схема алгоритма вывода значения функции}{out}{H}{1.0}

%\vfill
\clearpage
\ssec{Инструкция пользователю}
Программа позволяет вычислить значение сложной функции трёх вещественных аргументов.

Для работы программе необходимо передать 3 аргумента, от которых будет вычисляться значение функции. Введите их в указанные поля в окне программы, отделяя дробную часть от целой запятой. Возможна запись в экспоненциальной форме - показатель экспоненты указывается после буквы e. После ввода данных нажмите кнопку "Посчитать". 

Программа выведет результат в большое текстовое поле внизу окна. Для завершения работы программы нажмите кнопку "Выход".

\ 
\ssec{Инструкция программисту}
При разработке программы вычисления значения функции в модуле UnitMain, содержащем основную форму, были написаны следующие процедуры и функции:
%\suppressfloats[p]
\newcommand{\ftabO}[2]{
Параметры #1 представлены в таблице \ref{#2}.
}
\newcommand{\ftabI}[3]{
Параметры #1 представлены в таблице \ref{#2}, локальные переменные - в таблице \ref{#3}.
}
\newcommand{\ftabII}[3]{
Параметры-переменные #1 представлены в таблице \ref{#2}, локальные переменные - в таблице \ref{#3}.
}
\newcommand{\ftabIII}[4]{
Параметры-переменные #1 представлены в таблице \ref{#2}, параметры-значения - в таблице \ref{#3}, локальные переменные - в таблице \ref{#4}.
}

\newcounter{N}
\suppressfloats[t]
\begin{list}{\arabic{N}.}{\itemindent 1cm\addtolength{\itemindent}{\labelwidth}\listparindent 1.0cm\leftmargin 0cm\usecounter{N}}
\item Процедура btnRunClick - обработчик события шелчка мышки на кнопке btnRun - основная процедура программы.

procedure btnRunClick(Sender: TObject);

\ftabI{процедуры}{run:1}{run:2}
\tabl{Параметры процедуры запуска вычислений значения функции}
{Sender&TObject&объект-возбудитель события \\ \hline
}{run:1}{h}
\tabl{Локальные переменные процедуры запуска вычислений значения функции}
{x,y,z&Double&параметры расчёта значения функции \\ \hline
w   & Double &значение функции \\ \hline
\tabln{ok&boolean&флаг состояния программы}
}{run:2}{h}

\item Процедура-обработчик события btnExitClick при шелчке мышке по кнопке btnExit завершает приложение.

procedure btnExitClick(Sender: TObject);

\ftabO{процедуры}{exit:1}
\tabl{Параметры процедуры-обработчика событий шелчка мышки кнопки btnExit}
{Sender&TObject&объект-возбудитель события \\ \hline
}{exit:1}{H}
\item Процедура FormCreate добавляет к информационному полю memResult строку "w=". 

procedure FormCreate(Sender: TObject);

\ftabO{процедуры}{create:1}
\tabl{Параметры процедуры-обработчика событий создания формы frmMain}
{Sender&TObject&объект-возбудитель события \\ \hline
}{create:1}{H}
\end{list}

В библиотеке LabDLL были объявлены следующие функции:

\setcounter{N}{0}
\suppressfloats[t]
\begin{list}{\arabic{N}.}{\itemindent 1cm\addtolength{\itemindent}{\labelwidth}\listparindent 1.0cm\leftmargin 0cm\usecounter{N}}
\item Функция ShowForm показывает форму frmMain из модуля UnitMain  в модальном режиме.

Возвращает результат модального запуска.

function ShowForm: Integer;

\item Функция Input - получает значения параметров и возвращает True, если операция прошла успешно, иначе возвращает False.

function Input(var x,y,z:Double):boolean;

\ftabII{функции}{inp:1}{inp:2}
\tabl{Параметры функции ввода параметров рассчета}
{x,y,z&Double&параметры расчёта значения функции \\ \hline
}{inp:1}{h}
\tabl{Локальные переменные функции ввода параметров рассчета}{
errors&String&список ошибок ввода вывода \\ \hline
}{inp:2}{h}
\item Процедура Output выводит рассчитаное значение $w$ на форму.

procedure Output(w:Double);

\ftabO{процедуры}{out:1}
\tabl{Параметры процедуры вывода рассчитанного значения}
{w   & Double &значение функции \\ \hline
}{out:1}{h}
\item Функция CalcW рассчитывает и возвращает значение $w$.

function CalcW(x,y,z:Double):Double;

\ftabO{функции}{calc:1}
\tabl{Параметры функции получения значения w}
{x,y,z&Double&параметры расчета w\\ \hline
}{calc:1}{H}
\end{list}

Кроме того, написаны программы Lab6Static и Lab6Dynamic, подключающие библиотеку LabDLL статически и динамически соответственно, однако в них не содержатся определения функций и типов данных.
\clearpage
\ssec{Текст программы}
Ниже представлен текст модуля на языке Delphi 7, в котором содержится форма программы, реализующей расчёт значений функции и имеющей графический интерфейс.
\prog{Delphi}{UnitMain.pas}

Далее представлен текст динамической библиотеки, которая использует вышеприведенную форму.
\prog{Delphi}{LabDLL.dpr}

Ниже приведен текст приложения, использующего динамическую библиотеку при статическом связывании.
\prog{Delphi}{Lab6Static.dpr}

Далее приведен текст приложения, использующего динамическую библиотеку при динамическом связывании.
\prog{Delphi}{Lab6Dynamic.dpr}

\clearpage

\ 
\ssec{Тестовый пример}
Ниже на рисунке~\ref{scr:1} представлен общий вид окна программы.
\suppressfloats[t]
%\vfill
\pic{screen1.png}{Внешний вид программы}{scr:1}{h!}{1.0}
%clearpage

\ 
\ssec{Вывод}
В этой лабораторной работе я научился использовать библиотеки DLL при написании программ на Delphi. Динамические библиотеки позволяют использовать в собственных скомпилированный машинный код(без доступа к исходным текстам), причем не имеет значения исходный яхык написания библиотеки, а также позволяет подключать код не только во время компиляции, но и во время выполнения программы. Эти свойства делают динамические библиотеки чрезвычайно мощным инструментам, который позволяет и снизить трудозатраты, и сделать приложение более функциональным и гибким.
\end{document}
